{% extends 'tasks/base.html' %}

{% block title %}–ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç - TaskManager{% endblock %}

{% block content %}
<div class="card">
    <h1>üìä –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç</h1>
    
    {% if user.is_staff %}
    <a href="{% url 'make_payment' %}" class="btn btn-primary">üí≥ –ù–æ–≤–∞—è –≤—ã–ø–ª–∞—Ç–∞</a>
    {% endif %}
</div>

<div class="card">
    <div style="overflow-x: auto;">
        <table class="table">
            <thead>
                <tr>
                    {% if user.is_staff %}
                    <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                    {% else %}
                    <th>–û—Ç</th>
                    {% endif %}
                    <th>–°—É–º–º–∞</th>
                    <th>–î–∞—Ç–∞</th>
                    <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                </tr>
            </thead>
            <tbody>
                {% for payment in payments %}
                <tr>
                    {% if user.is_staff %}
                    <td>{{ payment.employee.get_full_name|default:payment.employee.username }}</td>
                    {% else %}
                    <td>{{ payment.manager.get_full_name|default:payment.manager.username }}</td>
                    {% endif %}
                    <td style="color: var(--success); font-weight: bold;">-{{ payment.amount }} —Ä—É–±.</td>
                    <td>{{ payment.payment_date|date:"d.m.Y H:i" }}</td>
                    <td>{{ payment.description|default:"‚Äî" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" style="text-align: center; color: var(--secondary); padding: 2rem;">
                        üì≠ –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –≤—ã–ø–ª–∞—Ç–∞—Ö
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}