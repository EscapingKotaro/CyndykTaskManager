<!-- tasks/_task_card_compact.html -->
<a href="{% url 'task_action' task.id %}" class="task-card-compact {{ task.get_priority_class }} {{ task.get_status_display_class }}">
    
    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å –¥–µ—Ç–∞–ª—è–º–∏ -->
    <div class="task-tooltip">
        <div class="tooltip-content">
            <div class="tooltip-row">
                <span class="tooltip-label">–°–æ–∑–¥–∞–Ω–∞:</span>
                <span>{{ task.created_by.get_display_name }}</span>
            </div>
            <div class="tooltip-row">
                <span class="tooltip-label">–°—Ä–æ–∫:</span>
                <span>{{ task.due_date|date:"d.m.Y" }}</span>
            </div>
            {% if task.controlled_by %}
            <div class="tooltip-row">
                <span class="tooltip-label">–ö–æ–Ω—Ç—Ä–æ–ª—å:</span>
                <span>{{ task.controlled_by.get_display_name }}</span>
            </div>
            {% endif %}
            {% if task.description %}
            <div class="tooltip-row" style="white-space: normal; max-width: 250px;">
                <span style="text-align: left;">{{ task.description|truncatewords:20 }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞—Ä—Ç–æ—á–∫–∏ -->
    <h4 class="task-title">{{ task.title }}</h4>
    
    <div class="task-meta-compact">
        <div class="task-assignee-compact">
            <span>üë§</span>
            <span>{{ task.assigned_to.get_display_name }}</span>
        </div>
        
        <div class="task-due-date-compact">
            <span>üìÖ</span>
            <span>{{ task.due_date|date:"d.m.Y" }}</span>
        </div>
        
        {% if task.payment_amount > 0 %}
        <div class="task-payment-compact">
            <span>üí∞</span>
            <span>{{ task.payment_amount }} —Ä—É–±.</span>
        </div>
        {% endif %}
    </div>
    
    <div class="task-badges">
        <span class="status-badge">{{ task.get_status_display }}</span>
        {% if task.is_overdue %}
            <span class="priority-badge">–ü–†–û–°–†–û–ß–ï–ù–ê</span>
        {% elif task.is_urgent %}
            <span class="priority-badge">–°–†–û–ß–ù–û</span>
        {% endif %}
    </div>
</a>